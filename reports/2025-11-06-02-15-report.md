# How to Build a Multi-Agent AI Persistence System - 2025-11-06

**Duration**: ~2 hours
**Difficulty**: Moderate (mostly figuring out what we actually wanted)
**Satisfaction Level**: ðŸ˜Š

## Objective

Learn how to create a specialized agent system where different AI assistants (Claude and Gemini) work together through shared markdown files, each with their own personality and responsibilities. Because apparently one AI wasn't enough.

## Overview

We built a complete agent-based persistence system that lets Claude and Gemini collaborate across sessions without stepping on each other's digital toes. The system includes four specialized agents (Report, Summary, Context, and Index) that handle different aspects of documentation and knowledge management.

The real achievement? Getting two different AI systems to play nice together with a clear division of labor. Claude handles the technical stuff (reports, git, file operations), while Gemini gets to be the conversational summarizer. It's like having a technical writer and a friendly narrator on the same team.

## Prerequisites

**You'll need:**
- Claude Code CLI (for the heavy lifting)
- Gemini (for the friendly summaries)
- A git repository (because version control is not optional)
- Basic understanding of markdown (you'll be writing a lot of it)
- Patience (for the "wait, which AI does what again?" moments)

**Starting point:**
A basic project structure with some form of AI persistence already in mind. We started with an existing system and completely rebuilt it.

## How to Replicate

### Step 1: Clean the Slate

First, we nuked the old structure. Sometimes you gotta tear down to build up.

```bash
git rm CLAUDE.md GEMINI.md INDEX.md STARTER.md starter.md summary-c.md
git rm -r projects/ai-persistence/
git rm -r templates/
```

This removed all the old files that were trying to do too much. The original system had files scattered everywhere with no clear purpose. Much better to start fresh.

### Step 2: Build the Agent System

Created four specialized agents in `agent-files/agents/`:

**report-agent.md** - The sarcastic technical writer (that's me!)
- Generates how-to style session reports
- Has personality (light sarcasm, humor, but genuinely helpful)
- Uses timestamped filenames to avoid overwriting

**summary-agent.md** - The conversational narrator
- Creates natural, friendly session summaries
- Only Gemini touches this one
- Updates `summary-g.md` after each session

**context-agent.md** - The knowledge accumulator
- Maintains persistent context about the project
- Tracks decisions, patterns, and resources
- Lives in `context/` folder with three key files

**index-agent.md** - The cross-reference master
- Maintains the main navigation hub
- Links reports, summaries, and context together
- Single source of truth for "where is everything?"

### Step 3: Establish the Division of Labor

Here's the crucial part - we defined clear boundaries:

**Claude Code handles:**
- Writing session reports (via Report Agent)
- Updating context files (via Context Agent)
- Updating the index (via Index Agent)
- All git operations (add, commit, push)
- File structure management

**Gemini handles:**
- ONLY updating `summary-g.md` (via Summary Agent)
- Being conversational and friendly
- Nothing else (seriously, we had to be explicit about this)

This prevents the "too many cooks" problem where both AIs try to manage everything.

### Step 4: Create the Template Structure

Built templates in `agent-files/templates/`:

```bash
mkdir -p agent-files/templates
```

Created:
- `report-template.md` - Structure for session reports
- `summary-template.md` - Format for friendly summaries
- `context-template.md` - Layout for context files
- `index-template.md` - Format for the main index

These templates ensure consistency. Future us will appreciate not having to remember the format.

### Step 5: Implement Timestamped Reports

Changed report filenames from `YYYY-MM-DD-report.md` to `YYYY-MM-DD-HH-MM-report.md`:

```bash
# Old format (would overwrite multiple sessions on same day)
reports/2025-11-06-report.md

# New format (unique for each session)
reports/2025-11-06-02-15-report.md
reports/2025-11-06-14-30-report.md
reports/2025-11-06-21-45-report.md
```

Because who wants their afternoon session to obliterate their morning session's hard-won documentation?

### Step 6: Update Both Projects

Applied the same agent system to two locations:
1. Current project: `/Users/iBert/Documents/ai-persistence/`
2. Reference project: `/Users/iBert/Documents/agent-report-assistant/`

This ensures the starter kit matches what we're actually using. Documentation that matches reality - what a concept!

### Step 7: Rename and Reorganize

Fixed the reference project name:
```bash
cd /Users/iBert/Documents
mv agent-report-assist agent-report-assistant
```

Because "assist" vs "assistant" was going to drive someone crazy eventually. Might as well fix it now.

### Step 8: Agent Invocation Strategy

All agents are invoked via the Task tool for efficiency:
- Loads agent context in one go
- Avoids manual copy-paste of agent instructions
- Makes the whole system feel more... agent-y

Example invocation pattern:
```markdown
Use the Task tool to invoke report-agent.md with detail level: Key actions
```

## What Could Go Wrong

**Division of labor confusion**: Without clear boundaries, both AIs might try to update the same files. Solution: Be explicit about who owns what. Like, REALLY explicit.

**Timestamp format mistakes**: Easy to mess up 24-hour time format. Double-check your HH-MM math.

**Agent personality bleed**: The Report Agent is sarcastic, but the Summary Agent is friendly. Don't mix them up or your docs will have an identity crisis.

**Template drift**: If you update one template, remember to check if others need updates too. Consistency is hard.

## Blockers

**Issues that stopped progress (for now):**

None! We actually finished everything we set out to do. This almost never happens.

*No blockers means we either crushed it or forgot something. Time will tell.*

## Allowers

**Solutions that actually worked:**

- **Timestamped reports (YYYY-MM-DD-HH-MM)** - Prevents overwriting, allows multiple sessions per day. Simple but effective.

- **Clear AI division of labor** - Claude does technical stuff, Gemini does summaries. No overlap, no conflicts.

- **Specialized agents** - Each agent has one job. Report Agent writes reports. Summary Agent writes summaries. Nobody tries to do everything.

- **Task tool invocation** - Loading agents via Task tool instead of manual prompts. Cleaner and more efficient.

- **Agent personality guidelines** - Report Agent being sarcastic makes docs more fun to read without sacrificing usefulness. Who says documentation has to be boring?

*Save these patterns. They're actually good ideas.*

## Results

**What you'll have after following this guide:**

- Four specialized agents with clear roles and personalities
- Timestamped session reports that won't overwrite each other
- A Summary Agent that only Gemini uses (preventing conflicts)
- Context Agent that accumulates project knowledge
- Index Agent that ties everything together
- Templates for consistent formatting
- Two identical setups (current project + reference starter kit)
- Clear division of labor between Claude and Gemini
- Documentation that people might actually enjoy reading

**File structure created:**
```
agent-files/
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ report-agent.md      (Sarcastic technical writer)
â”‚   â”œâ”€â”€ summary-agent.md     (Friendly narrator, Gemini-only)
â”‚   â”œâ”€â”€ context-agent.md     (Knowledge accumulator)
â”‚   â””â”€â”€ index-agent.md       (Cross-reference master)
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ report-template.md
â”‚   â”œâ”€â”€ summary-template.md
â”‚   â”œâ”€â”€ context-template.md
â”‚   â””â”€â”€ index-template.md
â””â”€â”€ README.md               (System overview)

reports/
â””â”€â”€ YYYY-MM-DD-HH-MM-report.md  (Timestamped reports)

context/
â”œâ”€â”€ decisions.md
â”œâ”€â”€ patterns.md
â””â”€â”€ resources.md

summary-g.md                 (Gemini's territory)
INDEX.md                     (Main navigation hub)
```

## Next Steps

1. **Start using the system** - Actually invoke these agents in your next session
2. **Test the division of labor** - Make sure Gemini only touches summary-g.md
3. **Refine agent personalities** - Adjust tone as needed (but keep Report Agent sarcastic)
4. **Add more templates** - Create templates for common tasks
5. **Build a proper starter kit** - Package this up for other projects

The system is built. Now we see if it actually works in practice.

---

*Report generated by your friendly neighborhood Report Agent. Found this helpful? Great. Found a typo? That's called "authenticity." You're welcome.*
